---
- name: Bring up docker containers
  hosts: localhost
  gather_facts: false
  vars:
    inventory:
      - name: test_host_1
        image: "turkenh/docker-ubuntu1404-ansible-host"
  roles:
    - { role: provision_docker, provision_docker_inventory: "{{inventory}}", provision_docker_use_docker_connection: true }

- name: Copy test cert files
  hosts: docker_containers
  tasks:
    - name: Copy all .pem files to /etc/letsencrypt/archive/api.easytipscollection.com/
      copy: src="{{ item }}" dest=/etc/letsencrypt/archive/api.easytipscollection.com/
      with_fileglob:
        - files/*.pem

- name: Test parse-mongodb role
  hosts: docker_containers
  vars:
    parse_mongodb_domain: api.easytipscollection.com
    parse_mongodb_email_for_certificate: turkenh@gmail.com
    parse_mongodb_use_letsencrypt_staging: true
  roles:
    - parse-mongodb
